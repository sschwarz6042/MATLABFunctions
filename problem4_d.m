function [t,y]=problem4_d()
%4th Order Runge-Kutta

    timeSteps=6000;
    h=17.065211656/timeSteps;

    y0=[0.994, 0, 0, 2.0015851063790825];
    
    y=zeros(6000, 4);
    t=zeros(6000, 1);
    
    u=0.012277471;
    v=1-u;
    
    for i=1:timeSteps
        if(i==1)
            de=((y0(1)+u)^2 + y0(3)^2)^(1/2);
            dm=((y0(1)-v)^2 + y0(3)^2)^(1/2);

            f1=y0(2);
            K1=0.1*f1;
            K2=0.1*(f1+(1/2)*K1);
            K3=0.1*(f1+(1/2)*K2);
            K4=0.1*(f1+K3);
            y(i,1)=y0(1)+(1/6)*(K1+2*K2+2*K3+K4);
               
            f2=(y0(1) + 2*y0(4) -v*((y0(1)+u) / (de^3)) -u*((y0(2)-v)/dm^3));
            K1=0.1*(f2);
            K2=0.1*(f2+(1/2)*K1);
            K3=0.1*(f2+(1/2)*K2);
            K4=0.1*(f2+K3);            
            y(i,2)=y0(2)+(1/6)*(K1+2*K2+2*K3+K4);
            
            f3=y0(4);
            K1=0.1*f3;
            K2=0.1*(f3+(1/2)*K1);
            K3=0.1*(f3+(1/2)*K2);
            K4=0.1*(f3+K3);            
            y(i,3)=y0(3)+(1/6)*(K1+2*K2+2*K3+K4);           
            
            f4=(y0(3) - 2*y0(2) -v*(y0(3)/(de^3)) -u*(y(3)/(dm^3)));
            K1=0.1*(f4);
            K2=0.1*(f4+(1/2)*K1);
            K3=0.1*(f4+(1/2)*K2);
            K4=0.1*(f4+(1/2)*K3);
            y(i,4)=y0(4)+(1/6)*(K1+2*K2+2*K3+K4);
        end
        
        if(i>1)
            de=((y(i-1, 1)+u)^2 + y(i-1, 3)^2)^(1/2);
            dm=((y(i-1, 1)-v)^2 + y(i-1, 3)^2)^(1/2);
            
            f1=y(i-1,2);
            K1=0.1*f1;
            K2=0.1*(f1+(1/2)*K1);
            K3=0.1*(f1+(1/2)*K2);
            K4=0.1*(f1+K3);
            y(i,1)=y(i-1,1)+(1/6)*(K1+2*K2+2*K3+K4);
                       
            f2=(y(i-1, 1) + 2*y(i-1, 4) -v*((y(i-1, 1)+u) / (de^3)) -u*((y(i-1, 2)-v)/dm^3));
            K1=0.1*(f2);
            K2=0.1*(f2+(1/2)*K1);
            K3=0.1*(f2+(1/2)*K2);
            K4=0.1*(f2+K3);            
            y(i,2)=y(i-1,2)+(1/6)*(K1+2*K2+2*K3+K4);
            
            f3=y(i-1,4);
            K1=0.1*f3;
            K2=0.1*(f3+(1/2)*K1);
            K3=0.1*(f3+(1/2)*K2);
            K4=0.1*(f3+K3);            
            y(i,3)=y(i-1,3)+(1/6)*(K1+2*K2+2*K3+K4);           
            
            f4=(y(i-1, 3) - 2*y(i-1, 2) -v*(y(i-1, 3)/(de^3)) -u*(y(i-1, 3)/(dm^3)));
            K1=0.1*(f4);
            K2=0.1*(f4+(1/2)*K1);
            K3=0.1*(f4+(1/2)*K2);
            K4=0.1*(f4+(1/2)*K3);
            y(i,4)=y(i-1,4)+(1/6)*(K1+2*K2+2*K3+K4);        
        end 
        
        t(i, 1)=i*h;
    end    

end